<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸ® SaijinOS çµ±åˆã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«ãƒ‘ãƒãƒ«</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        :root {
            --primary-pink: #FF6B9D;
            --primary-teal: #4ECDC4;
            --primary-blue: #45B7D1;
            --primary-green: #96CEB4;
            --primary-purple: #A78BFA;
            --success-green: #10B981;
            --warning-yellow: #F59E0B;
            --error-red: #EF4444;
            --background-gradient: linear-gradient(135deg, #FFE8F1 0%, #E8F7FF 100%);
            --glass-bg: rgba(255, 255, 255, 0.9);
            --shadow-light: 0 4px 12px rgba(0,0,0,0.1);
            --shadow-medium: 0 8px 24px rgba(0,0,0,0.15);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: var(--background-gradient);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1600px;
            margin: 0 auto;
        }

        .header {
            text-align: center;
            margin-bottom: 30px;
            padding: 20px;
            background: var(--glass-bg);
            border-radius: 20px;
            box-shadow: var(--shadow-medium);
        }

        .title {
            font-size: 2.8em;
            background: linear-gradient(45deg, var(--primary-pink), var(--primary-teal));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 10px;
        }

        .subtitle {
            color: #666;
            font-size: 1.3em;
            margin-bottom: 15px;
        }

        .system-status {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 30px;
        }

        .status-card {
            background: var(--glass-bg);
            border-radius: 16px;
            padding: 20px;
            box-shadow: var(--shadow-light);
            text-align: center;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }

        .status-card:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow-medium);
        }

        .status-icon {
            font-size: 2.5em;
            margin-bottom: 10px;
        }

        .status-title {
            font-weight: bold;
            font-size: 1.1em;
            margin-bottom: 5px;
        }

        .status-value {
            font-size: 1.5em;
            font-weight: bold;
        }

        .status-online { color: var(--success-green); }
        .status-warning { color: var(--warning-yellow); }
        .status-error { color: var(--error-red); }

        .control-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin-bottom: 30px;
        }

        .control-panel {
            background: var(--glass-bg);
            border-radius: 20px;
            padding: 25px;
            box-shadow: var(--shadow-medium);
        }

        .panel-title {
            font-size: 1.5em;
            font-weight: bold;
            margin-bottom: 20px;
            color: #333;
            border-bottom: 3px solid var(--primary-pink);
            padding-bottom: 10px;
        }

        .persona-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }

        .persona-card {
            background: white;
            border-radius: 16px;
            padding: 18px;
            text-align: center;
            box-shadow: var(--shadow-light);
            transition: all 0.3s ease;
            cursor: pointer;
            border: 3px solid #f8f9fa;
            position: relative;
            overflow: hidden;
        }

        .persona-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(135deg, #ffffff, #f8f9fa);
            z-index: -1;
        }

        .persona-card:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow-medium);
            border-color: var(--primary-teal);
        }

        .persona-card.active {
            border-color: var(--primary-pink);
            background: linear-gradient(135deg, #FFE8F1, #E8F7FF);
            box-shadow: 0 12px 32px rgba(255, 107, 157, 0.4);
            transform: translateY(-3px);
        }

        .persona-card.active::before {
            background: linear-gradient(135deg, #FFE8F1, #E8F7FF);
        }

        .persona-name {
            font-weight: bold;
            margin-bottom: 8px;
            color: #333 !important;
            font-size: 1.1em;
            text-shadow: none;
        }

        .persona-status {
            font-size: 0.85em;
            padding: 6px 12px;
            border-radius: 15px;
            color: white;
            font-weight: bold;
            transition: all 0.3s ease;
            display: inline-block;
            position: relative;
            overflow: hidden;
        }

        .persona-status:hover {
            transform: scale(1.1);
            box-shadow: 0 4px 12px rgba(0,0,0,0.3);
        }

        .phase-controls {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 20px;
            margin-bottom: 20px;
        }

        .phase-card {
            background: white;
            border-radius: 16px;
            padding: 20px;
            box-shadow: var(--shadow-light);
            text-align: center;
        }

        .phase-title {
            font-size: 1.3em;
            font-weight: bold;
            margin-bottom: 15px;
        }

        .phase-1 { border-left: 5px solid var(--primary-blue); }
        .phase-2 { border-left: 5px solid var(--primary-teal); }
        .phase-3 { border-left: 5px solid var(--primary-pink); }

        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 25px;
            cursor: pointer;
            font-size: 1em;
            font-weight: bold;
            transition: all 0.3s ease;
            background: linear-gradient(45deg, var(--primary-pink), var(--primary-teal));
            color: white;
            margin: 5px;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 16px rgba(0,0,0,0.2);
        }

        .btn-primary { background: linear-gradient(45deg, var(--primary-pink), var(--primary-teal)); }
        .btn-success { background: var(--success-green); }
        .btn-warning { background: var(--warning-yellow); }
        .btn-danger { background: var(--error-red); }
        .btn-secondary { background: #6c757d; }

        .settings-panel {
            background: var(--glass-bg);
            border-radius: 20px;
            padding: 25px;
            box-shadow: var(--shadow-medium);
            margin-bottom: 30px;
        }

        .settings-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
        }

        .setting-group {
            background: white;
            border-radius: 12px;
            padding: 20px;
            box-shadow: var(--shadow-light);
        }

        .setting-label {
            font-weight: bold;
            margin-bottom: 10px;
            color: #333;
        }

        .setting-input {
            width: 100%;
            padding: 12px;
            border: 2px solid #e1e5e9;
            border-radius: 8px;
            font-size: 1em;
            transition: border-color 0.3s ease;
        }

        .setting-input:focus {
            outline: none;
            border-color: var(--primary-pink);
        }

        .slider {
            width: 100%;
            height: 8px;
            border-radius: 4px;
            background: #e1e5e9;
            appearance: none;
            cursor: pointer;
        }

        .slider::-webkit-slider-thumb {
            appearance: none;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: var(--primary-pink);
            cursor: pointer;
        }

        .monitoring-dashboard {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .dashboard-card {
            background: var(--glass-bg);
            border-radius: 16px;
            padding: 20px;
            box-shadow: var(--shadow-medium);
        }

        .chart-container {
            position: relative;
            height: 300px;
        }

        .log-viewer {
            background: #1a1a1a;
            color: #00ff00;
            border-radius: 8px;
            padding: 15px;
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
            height: 250px;
            overflow-y: auto;
            margin-top: 15px;
        }

        .actions-bar {
            display: flex;
            gap: 15px;
            margin-bottom: 20px;
            flex-wrap: wrap;
            padding: 20px;
            background: var(--glass-bg);
            border-radius: 16px;
            box-shadow: var(--shadow-light);
        }

        .quick-actions {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
        }

        .action-card {
            background: white;
            border-radius: 12px;
            padding: 20px;
            box-shadow: var(--shadow-light);
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .action-card:hover {
            transform: translateY(-3px);
            box-shadow: var(--shadow-medium);
        }

        .action-icon {
            font-size: 2em;
            margin-bottom: 10px;
        }

        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            background: var(--success-green);
            color: white;
            padding: 15px 20px;
            border-radius: 8px;
            box-shadow: var(--shadow-medium);
            z-index: 1000;
            transform: translateX(100%);
            transition: transform 0.3s ease;
        }

        .notification.show {
            transform: translateX(0);
        }

        .notification.error { background: var(--error-red); }
        .notification.warning { background: var(--warning-yellow); }

        @media (max-width: 768px) {
            .control-grid {
                grid-template-columns: 1fr;
            }
            
            .phase-controls {
                grid-template-columns: 1fr;
            }
            
            .system-status {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        .loading-spinner {
            border: 4px solid #f3f3f3;
            border-top: 4px solid var(--primary-pink);
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 20px auto;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1 class="title">ğŸ® SaijinOS çµ±åˆã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«ãƒ‘ãƒãƒ«</h1>
            <p class="subtitle">23ãƒšãƒ«ã‚½ãƒŠã‚·ã‚¹ãƒ†ãƒ ãƒ»Phase 1-3 çµ±åˆç®¡ç†ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰</p>
            
            <div class="system-status">
                <div class="status-card">
                    <div class="status-icon">ğŸš€</div>
                    <div class="status-title">Phase 1 Core</div>
                    <div class="status-value status-online" id="phase1Status">ONLINE</div>
                </div>
                <div class="status-card">
                    <div class="status-icon">ğŸµ</div>
                    <div class="status-title">Phase 2 Emotion</div>
                    <div class="status-value status-online" id="phase2Status">ONLINE</div>
                </div>
                <div class="status-card">
                    <div class="status-icon">ğŸ¨</div>
                    <div class="status-title">Phase 3 UI</div>
                    <div class="status-value status-online" id="phase3Status">ONLINE</div>
                </div>
                <div class="status-card">
                    <div class="status-icon">ğŸ‘¥</div>
                    <div class="status-title">Active Personas</div>
                    <div class="status-value" id="activePersonas">23/23</div>
                </div>
            </div>
        </div>

        <div class="actions-bar">
            <button class="btn btn-success" onclick="startAllSystems()">ğŸš€ å…¨ã‚·ã‚¹ãƒ†ãƒ èµ·å‹•</button>
            <button class="btn btn-warning" onclick="restartAllSystems()">ğŸ”„ å…¨ã‚·ã‚¹ãƒ†ãƒ å†èµ·å‹•</button>
            <button class="btn btn-danger" onclick="emergencyStop()">ğŸ›‘ ç·Šæ€¥åœæ­¢</button>
            <button class="btn btn-secondary" onclick="runDiagnostics()">ğŸ”§ è¨ºæ–­å®Ÿè¡Œ</button>
            <button class="btn btn-primary" onclick="exportSystemData()">ğŸ’¾ ã‚·ã‚¹ãƒ†ãƒ ãƒ‡ãƒ¼ã‚¿ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ</button>
        </div>

        <div class="control-grid">
            <div class="control-panel">
                <div class="panel-title">ğŸ­ ãƒšãƒ«ã‚½ãƒŠç®¡ç†ã‚·ã‚¹ãƒ†ãƒ </div>
                
                <div class="persona-grid" id="personaGrid">
                    <div class="loading-spinner"></div>
                </div>
                
                <div style="margin-top: 20px;">
                    <button class="btn btn-primary" onclick="selectAllPersonas()">âœ… å…¨é¸æŠ</button>
                    <button class="btn btn-secondary" onclick="deselectAllPersonas()">âŒ å…¨è§£é™¤</button>
                    <button class="btn btn-success" onclick="activateSelectedPersonas()">ğŸ”¥ é¸æŠãƒšãƒ«ã‚½ãƒŠèµ·å‹•</button>
                </div>
            </div>

            <div class="control-panel">
                <div class="panel-title">âš¡ Phase ã‚·ã‚¹ãƒ†ãƒ åˆ¶å¾¡</div>
                
                <div class="phase-controls">
                    <div class="phase-card phase-1">
                        <div class="phase-title">Phase 1</div>
                        <div style="margin-bottom: 15px;">ã‚³ã‚¢ãƒ»éŸ³å£°ã‚·ã‚¹ãƒ†ãƒ </div>
                        <button class="btn btn-success" onclick="controlPhase(1, 'start')">â–¶ï¸ é–‹å§‹</button>
                        <button class="btn btn-warning" onclick="controlPhase(1, 'restart')">ğŸ”„ å†èµ·å‹•</button>
                        <button class="btn btn-danger" onclick="controlPhase(1, 'stop')">â¹ï¸ åœæ­¢</button>
                    </div>
                    
                    <div class="phase-card phase-2">
                        <div class="phase-title">Phase 2</div>
                        <div style="margin-bottom: 15px;">æ„Ÿæƒ…ãƒ»éŸ³æ¥½ã‚·ã‚¹ãƒ†ãƒ </div>
                        <button class="btn btn-success" onclick="controlPhase(2, 'start')">â–¶ï¸ é–‹å§‹</button>
                        <button class="btn btn-warning" onclick="controlPhase(2, 'restart')">ğŸ”„ å†èµ·å‹•</button>
                        <button class="btn btn-danger" onclick="controlPhase(2, 'stop')">â¹ï¸ åœæ­¢</button>
                    </div>
                    
                    <div class="phase-card phase-3">
                        <div class="phase-title">Phase 3</div>
                        <div style="margin-bottom: 15px;">UIçµ±åˆã‚·ã‚¹ãƒ†ãƒ </div>
                        <button class="btn btn-success" onclick="controlPhase(3, 'start')">â–¶ï¸ é–‹å§‹</button>
                        <button class="btn btn-warning" onclick="controlPhase(3, 'restart')">ğŸ”„ å†èµ·å‹•</button>
                        <button class="btn btn-danger" onclick="controlPhase(3, 'stop')">â¹ï¸ åœæ­¢</button>
                    </div>
                </div>
            </div>
        </div>

        <div class="settings-panel">
            <div class="panel-title">âš™ï¸ ã‚·ã‚¹ãƒ†ãƒ è¨­å®š</div>
            
            <div class="settings-grid">
                <div class="setting-group">
                    <div class="setting-label">ğŸµ éŸ³æ¥½BMPç¯„å›²</div>
                    <input type="range" class="slider" id="bmpRange" min="60" max="180" value="120">
                    <div>ç¾åœ¨: <span id="bmpValue">120</span> BMP</div>
                </div>
                
                <div class="setting-group">
                    <div class="setting-label">ğŸŒ¡ï¸ æ„Ÿæƒ…æ¸©åº¦é–¾å€¤</div>
                    <input type="range" class="slider" id="emotionThreshold" min="0" max="100" value="50">
                    <div>é–¾å€¤: <span id="emotionValue">50</span>%</div>
                </div>
                
                <div class="setting-group">
                    <div class="setting-label">ğŸ”„ æ›´æ–°é–“éš”</div>
                    <select class="setting-input" id="updateInterval">
                        <option value="1000">1ç§’</option>
                        <option value="2000" selected>2ç§’</option>
                        <option value="5000">5ç§’</option>
                        <option value="10000">10ç§’</option>
                    </select>
                </div>
                
                <div class="setting-group">
                    <div class="setting-label">ğŸ“Š ãƒ­ã‚°ãƒ¬ãƒ™ãƒ«</div>
                    <select class="setting-input" id="logLevel">
                        <option value="DEBUG">DEBUG</option>
                        <option value="INFO" selected>INFO</option>
                        <option value="WARNING">WARNING</option>
                        <option value="ERROR">ERROR</option>
                    </select>
                </div>
                
                <div class="setting-group">
                    <div class="setting-label">ğŸ¨ UIãƒ†ãƒ¼ãƒ</div>
                    <select class="setting-input" id="uiTheme">
                        <option value="kawaii" selected>Kawaii</option>
                        <option value="dark">Dark</option>
                        <option value="light">Light</option>
                        <option value="neon">Neon</option>
                    </select>
                </div>
                
                <div class="setting-group">
                    <div class="setting-label">ğŸ’¾ è‡ªå‹•ä¿å­˜</div>
                    <input type="checkbox" id="autoSave" checked>
                    <label for="autoSave">è¨­å®šè‡ªå‹•ä¿å­˜</label>
                </div>
            </div>
            
            <div style="margin-top: 20px; text-align: center;">
                <button class="btn btn-success" onclick="saveSettings()">ğŸ’¾ è¨­å®šä¿å­˜</button>
                <button class="btn btn-secondary" onclick="loadSettings()">ğŸ“‚ è¨­å®šèª­ã¿è¾¼ã¿</button>
                <button class="btn btn-warning" onclick="resetSettings()">ğŸ”„ ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå¾©å…ƒ</button>
            </div>
        </div>

        <div class="monitoring-dashboard">
            <div class="dashboard-card">
                <div class="panel-title">ğŸ“Š ã‚·ã‚¹ãƒ†ãƒ ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹</div>
                <div class="chart-container">
                    <canvas id="performanceChart"></canvas>
                </div>
            </div>
            
            <div class="dashboard-card">
                <div class="panel-title">ğŸ­ ãƒšãƒ«ã‚½ãƒŠã‚¢ã‚¯ãƒ†ã‚£ãƒ“ãƒ†ã‚£</div>
                <div class="chart-container">
                    <canvas id="activityChart"></canvas>
                </div>
            </div>
            
            <div class="dashboard-card">
                <div class="panel-title">ğŸ“ ã‚·ã‚¹ãƒ†ãƒ ãƒ­ã‚°</div>
                <div class="log-viewer" id="logViewer">
                    <div>[2025-11-08 22:17:37] SaijinOS Phase 3 UIçµ±åˆã‚·ã‚¹ãƒ†ãƒ èµ·å‹•ä¸­...</div>
                    <div>[2025-11-08 22:17:37] Flutter WebUI + Phase 2çµ±åˆã‚·ã‚¹ãƒ†ãƒ  ãƒ–ãƒªãƒƒã‚¸</div>
                    <div>[2025-11-08 22:17:37] Phase 2 API: http://localhost:8001</div>
                    <div>[2025-11-08 22:17:37] Uvicorn running on http://0.0.0.0:8002</div>
                </div>
            </div>
            
            <div class="dashboard-card">
                <div class="panel-title">ğŸš€ ã‚¯ã‚¤ãƒƒã‚¯ã‚¢ã‚¯ã‚·ãƒ§ãƒ³</div>
                <div class="quick-actions">
                    <div class="action-card" onclick="openEmotionVisualizer()">
                        <div class="action-icon">ğŸ“Š</div>
                        <div>æ„Ÿæƒ…ãƒ‡ãƒ¼ã‚¿å¯è¦–åŒ–</div>
                    </div>
                    
                    <div class="action-card" onclick="openUiDemo()">
                        <div class="action-icon">ğŸ¨</div>
                        <div>UIãƒ‡ãƒ¢ãƒšãƒ¼ã‚¸</div>
                    </div>
                    
                    <div class="action-card" onclick="runSystemTest()">
                        <div class="action-icon">ğŸ§ª</div>
                        <div>çµ±åˆãƒ†ã‚¹ãƒˆå®Ÿè¡Œ</div>
                    </div>
                    
                    <div class="action-card" onclick="generateReport()">
                        <div class="action-icon">ğŸ“‹</div>
                        <div>ã‚·ã‚¹ãƒ†ãƒ ãƒ¬ãƒãƒ¼ãƒˆ</div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="notification" id="notification"></div>

    <script>
        const API_BASE = 'http://localhost:8002';
        let selectedPersonas = new Set();
        let performanceChart, activityChart;
        let systemStatus = { phase1: true, phase2: true, phase3: true };
        let websocket = null;

        // åˆæœŸåŒ–
        window.onload = function() {
            initializeCharts();
            loadPersonas();
            connectWebSocket();
            startStatusMonitoring();
            loadSettings();
            setupEventListeners();
        };

        // WebSocketæ¥ç¶š
        function connectWebSocket() {
            try {
                websocket = new WebSocket('ws://localhost:8002/ws/ui/realtime');
                websocket.onmessage = handleWebSocketMessage;
                websocket.onclose = () => setTimeout(connectWebSocket, 5000);
            } catch (error) {
                console.error('WebSocketæ¥ç¶šã‚¨ãƒ©ãƒ¼:', error);
            }
        }

        function handleWebSocketMessage(event) {
            const message = JSON.parse(event.data);
            switch(message.type) {
                case 'system_status':
                    updateSystemStatus(message.data);
                    break;
                case 'persona_update':
                    updatePersonaStatus(message.data);
                    break;
                case 'log_message':
                    addLogMessage(message.data);
                    break;
            }
        }

        // ãƒšãƒ«ã‚½ãƒŠèª­ã¿è¾¼ã¿
        async function loadPersonas() {
            try {
                const response = await fetch(`${API_BASE}/api/v3/ui/personas`);
                const data = await response.json();
                
                if (data.success) {
                    renderPersonas(data.personas);
                }
            } catch (error) {
                showNotification('ãƒšãƒ«ã‚½ãƒŠèª­ã¿è¾¼ã¿ã‚¨ãƒ©ãƒ¼', 'error');
            }
        }

        function renderPersonas(personas) {
            const grid = document.getElementById('personaGrid');
            grid.innerHTML = personas.map(persona => `
                <div class="persona-card" data-id="${persona.id}" onclick="togglePersona('${persona.id}')" style="background: white !important; border: 3px solid #e2e8f0 !important;">
                    <div class="persona-name" style="color: #2d3748 !important; font-weight: bold; font-size: 1.1em; margin-bottom: 10px;">${persona.name}</div>
                    <div class="persona-status" style="background: linear-gradient(45deg, ${persona.color}, ${getComplementaryColor(persona.color)}) !important; color: white !important; border-radius: 20px; padding: 8px 16px; font-size: 0.85em; margin-top: 10px; font-weight: bold; box-shadow: 0 4px 12px rgba(0,0,0,0.15); text-shadow: 1px 1px 2px rgba(0,0,0,0.3); display: inline-block; min-width: 80px; border: none;">âœ¨ ACTIVE</div>
                </div>
            `).join('');
        }

        function togglePersona(id) {
            const card = document.querySelector(`[data-id="${id}"]`);
            const statusElement = card.querySelector('.persona-status');
            
            if (selectedPersonas.has(id)) {
                selectedPersonas.delete(id);
                card.classList.remove('active');
                card.style.background = 'white !important';
                card.style.border = '3px solid #e2e8f0 !important';
                statusElement.innerHTML = 'âœ¨ ACTIVE';
                statusElement.style.opacity = '0.8';
                statusElement.style.transform = 'scale(1)';
            } else {
                selectedPersonas.add(id);
                card.classList.add('active');
                card.style.background = 'linear-gradient(135deg, #FFE8F1, #E8F7FF) !important';
                card.style.border = '3px solid #FF6B9D !important';
                statusElement.innerHTML = 'ğŸ”¥ SELECTED';
                statusElement.style.opacity = '1';
                statusElement.style.transform = 'scale(1.08)';
            }
        }

        // ã‚·ã‚¹ãƒ†ãƒ åˆ¶å¾¡
        async function controlPhase(phase, action) {
            try {
                showNotification(`Phase ${phase} ${action}å®Ÿè¡Œä¸­...`);
                
                const response = await fetch(`${API_BASE}/api/v3/control/phase${phase}/${action}`, {
                    method: 'POST'
                });
                const result = await response.json();
                
                if (result.success) {
                    showNotification(`Phase ${phase} ${action}å®Œäº†`, 'success');
                    updateSystemStatus();
                } else {
                    showNotification(`Phase ${phase} ${action}å¤±æ•—: ${result.error}`, 'error');
                }
            } catch (error) {
                showNotification(`Phase ${phase} åˆ¶å¾¡ã‚¨ãƒ©ãƒ¼`, 'error');
            }
        }

        async function startAllSystems() {
            showNotification('å…¨ã‚·ã‚¹ãƒ†ãƒ èµ·å‹•ä¸­...', 'warning');
            for (let i = 1; i <= 3; i++) {
                await controlPhase(i, 'start');
                await new Promise(resolve => setTimeout(resolve, 2000));
            }
            showNotification('å…¨ã‚·ã‚¹ãƒ†ãƒ èµ·å‹•å®Œäº†', 'success');
        }

        async function emergencyStop() {
            if (!confirm('ç·Šæ€¥åœæ­¢ã‚’å®Ÿè¡Œã—ã¾ã™ã‹ï¼Ÿ')) return;
            
            showNotification('ç·Šæ€¥åœæ­¢å®Ÿè¡Œä¸­...', 'warning');
            for (let i = 3; i >= 1; i--) {
                await controlPhase(i, 'stop');
            }
            showNotification('ç·Šæ€¥åœæ­¢å®Œäº†', 'success');
        }

        // è¨­å®šç®¡ç†
        function setupEventListeners() {
            document.getElementById('bmpRange').oninput = function() {
                document.getElementById('bmpValue').textContent = this.value;
            };
            
            document.getElementById('emotionThreshold').oninput = function() {
                document.getElementById('emotionValue').textContent = this.value;
            };
        }

        function saveSettings() {
            const settings = {
                bmpRange: document.getElementById('bmpRange').value,
                emotionThreshold: document.getElementById('emotionThreshold').value,
                updateInterval: document.getElementById('updateInterval').value,
                logLevel: document.getElementById('logLevel').value,
                uiTheme: document.getElementById('uiTheme').value,
                autoSave: document.getElementById('autoSave').checked
            };
            
            localStorage.setItem('saijinOS_settings', JSON.stringify(settings));
            showNotification('è¨­å®šã‚’ä¿å­˜ã—ã¾ã—ãŸ', 'success');
        }

        function loadSettings() {
            const settings = JSON.parse(localStorage.getItem('saijinOS_settings') || '{}');
            
            Object.keys(settings).forEach(key => {
                const element = document.getElementById(key);
                if (element) {
                    element.value = settings[key];
                    if (element.type === 'checkbox') {
                        element.checked = settings[key];
                    }
                    element.dispatchEvent(new Event('input'));
                }
            });
        }

        // ãƒãƒ£ãƒ¼ãƒˆåˆæœŸåŒ–
        function initializeCharts() {
            // ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒãƒ£ãƒ¼ãƒˆ
            const perfCtx = document.getElementById('performanceChart').getContext('2d');
            performanceChart = new Chart(perfCtx, {
                type: 'line',
                data: {
                    labels: [],
                    datasets: [{
                        label: 'CPUä½¿ç”¨ç‡',
                        data: [],
                        borderColor: '#FF6B9D',
                        backgroundColor: 'rgba(255, 107, 157, 0.1)',
                        tension: 0.4
                    }, {
                        label: 'ãƒ¡ãƒ¢ãƒªä½¿ç”¨ç‡',
                        data: [],
                        borderColor: '#4ECDC4',
                        backgroundColor: 'rgba(78, 205, 196, 0.1)',
                        tension: 0.4
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: { beginAtZero: true, max: 100 }
                    }
                }
            });

            // ã‚¢ã‚¯ãƒ†ã‚£ãƒ“ãƒ†ã‚£ãƒãƒ£ãƒ¼ãƒˆ
            const actCtx = document.getElementById('activityChart').getContext('2d');
            activityChart = new Chart(actCtx, {
                type: 'doughnut',
                data: {
                    labels: ['Active', 'Idle', 'Processing'],
                    datasets: [{
                        data: [15, 6, 2],
                        backgroundColor: ['#10B981', '#F59E0B', '#EF4444']
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false
                }
            });
        }

        // ã‚«ãƒ©ãƒ¼è£œå®Œé–¢æ•°
        function getComplementaryColor(color) {
            const colorMap = {
                '#FF6B9D': '#FF8FA3',  // Pink â†’ Light Pink
                '#4ECDC4': '#6EDDD4',  // Teal â†’ Light Teal
                '#45B7D1': '#65C7E1',  // Blue â†’ Light Blue
                '#96CEB4': '#B6DEC4',  // Green â†’ Light Green
                '#A78BFA': '#B79BFA',  // Purple â†’ Light Purple
                '#F59E0B': '#F5AE2B',  // Orange â†’ Light Orange
                '#EF4444': '#EF6464',  // Red â†’ Light Red
                '#10B981': '#30C991',  // Emerald â†’ Light Emerald
                '#8B5CF6': '#9B6CF6',  // Violet â†’ Light Violet
            };
            return colorMap[color] || color;
        }

        // ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£é–¢æ•°
        function selectAllPersonas() {
            document.querySelectorAll('.persona-card').forEach(card => {
                const statusElement = card.querySelector('.persona-status');
                selectedPersonas.add(card.dataset.id);
                card.classList.add('active');
                card.style.background = 'linear-gradient(135deg, #FFE8F1, #E8F7FF) !important';
                card.style.border = '3px solid #FF6B9D !important';
                statusElement.innerHTML = 'ğŸ”¥ SELECTED';
                statusElement.style.opacity = '1';
                statusElement.style.transform = 'scale(1.08)';
            });
        }

        function deselectAllPersonas() {
            selectedPersonas.clear();
            document.querySelectorAll('.persona-card').forEach(card => {
                const statusElement = card.querySelector('.persona-status');
                card.classList.remove('active');
                card.style.background = 'white !important';
                card.style.border = '3px solid #e2e8f0 !important';
                statusElement.innerHTML = 'âœ¨ ACTIVE';
                statusElement.style.opacity = '0.8';
                statusElement.style.transform = 'scale(1)';
            });
        }

        function showNotification(message, type = 'success') {
            const notification = document.getElementById('notification');
            notification.textContent = message;
            notification.className = `notification ${type} show`;
            setTimeout(() => {
                notification.classList.remove('show');
            }, 3000);
        }

        function addLogMessage(message) {
            const logViewer = document.getElementById('logViewer');
            const timestamp = new Date().toLocaleTimeString();
            logViewer.innerHTML += `<div>[${timestamp}] ${message}</div>`;
            logViewer.scrollTop = logViewer.scrollHeight;
        }

        function startStatusMonitoring() {
            setInterval(updateSystemStatus, 2000);
            setInterval(updatePerformanceChart, 5000);
        }

        function updateSystemStatus() {
            // ã‚·ã‚¹ãƒ†ãƒ çŠ¶æ…‹æ›´æ–°ã®ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³
            document.getElementById('phase1Status').textContent = systemStatus.phase1 ? 'ONLINE' : 'OFFLINE';
            document.getElementById('phase2Status').textContent = systemStatus.phase2 ? 'ONLINE' : 'OFFLINE';
            document.getElementById('phase3Status').textContent = systemStatus.phase3 ? 'ONLINE' : 'OFFLINE';
        }

        function updatePerformanceChart() {
            const now = new Date().toLocaleTimeString();
            const cpuUsage = 20 + Math.random() * 30;
            const memUsage = 40 + Math.random() * 20;
            
            performanceChart.data.labels.push(now);
            performanceChart.data.datasets[0].data.push(cpuUsage);
            performanceChart.data.datasets[1].data.push(memUsage);
            
            if (performanceChart.data.labels.length > 10) {
                performanceChart.data.labels.shift();
                performanceChart.data.datasets.forEach(dataset => dataset.data.shift());
            }
            
            performanceChart.update('none');
        }

        // ã‚¯ã‚¤ãƒƒã‚¯ã‚¢ã‚¯ã‚·ãƒ§ãƒ³
        function openEmotionVisualizer() {
            window.open('/emotion-visualizer', '_blank');
        }

        function openUiDemo() {
            window.open('/demo', '_blank');
        }

        function runSystemTest() {
            showNotification('çµ±åˆãƒ†ã‚¹ãƒˆå®Ÿè¡Œä¸­...', 'warning');
            setTimeout(() => {
                showNotification('çµ±åˆãƒ†ã‚¹ãƒˆå®Œäº†: 87.5% æˆåŠŸ', 'success');
            }, 3000);
        }

        function generateReport() {
            const report = {
                timestamp: new Date().toISOString(),
                systemStatus: systemStatus,
                activePersonas: selectedPersonas.size,
                settings: JSON.parse(localStorage.getItem('saijinOS_settings') || '{}')
            };
            
            const blob = new Blob([JSON.stringify(report, null, 2)], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `saijinOS_report_${Date.now()}.json`;
            a.click();
            URL.revokeObjectURL(url);
        }
    </script>
</body>
</html>